<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>JavaScript Quiz Project</title>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
  <style type="text/css">
	  .col-sm-6 {
		  padding: 10px;
	  }
	  .pageMovement {
		  margin-top: 25px;
	  }
    .answer {
      margin-left: auto;
      margin-right: auto;
      display: block;
      width: 80%;
      background: #E6FFE2;
    }
    .container {
      border: solid 1px #D8D8D8;
    }

    .hide {
      display: none;
    }

    .show {
      display: block;
    }
		#finishQuiz {
			margin-top: 25px;
		}
		.output {
			font-size: 20px;
		}
		.glyphicon-ok-circle {
			color: #00FF64;	
		}
		.glyphicon-remove-circle {
			color: #FF0004;
		}
		.fa-check-circle-o {
			color: #00FF64;				
		}
		.fa-times-circle-o {
			color: #FF0004;
		}
		.selAnswer {
			background: #4E9267;
		}

  </style>
</head>
<body>
  <div class="container">
    <h1>Welcome to my Quiz</h1>
    <div id="quizContent" class="row quiz">
    	<div class="col-sm-12">
        <h2 id="quizHeader"></h2>
        <img src="" alt="Placeholder Image" class="img-responsive" id="quizimage">
      </div>
      <div class="row" id="questions">
        <div class="col-sm-6"><a data-id="1" class="btn btn-default answer">1</a></div>
        <div class="col-sm-6"><a data-id="2" class="btn btn-default answer">2</a></div>
        <div class="col-sm-6"><a data-id="3" class="btn btn-default answer">3</a></div>
        <div class="col-sm-6"><a data-id="4" class="btn btn-default answer">4</a></div>
      </div>
    </div>

    <div class="row pageMovement">
    	<div id="btnPrevious" class="col-xs-5 col-sm-4 btn btn-primary pull-left">Previous</div>
      <div id="btnNext" class="col-xs-5 col-sm-4 col-sm-offset-4 col-xs-offset-2 btn btn-primary" pull-right>Next</div>
    </div>
    <br>
    <div class="row">
    	<div id="finishQuiz" class="btn btn-success btn-block hide">Submit Quiz</div>
    </div>
    <br><br>
  	<div class="progress">
		  <div id="progressbar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%"></div>
		</div>  
  </div>

</body>
</html>
<script src="json.js"></script>
<script type="text/javascript">
//	console.log(data.quizcontent);
//	for(var obj in data.quizcontent){
//		console.log(data.quizcontent[obj].question);
//	}
  var curPage = 0, correct = 0;
	var myAnswers = [];
	/// [ HEADER, IMAGE, CORRECT ANSWER, ANSWER 1, ANSWER 2, ANSWER 3, ANSWER 4]
  var myQuiz = [
    ["What is \" ' \" Quote show without error \"  is addEventListener() used for?", "http://placehold.it/200x200", 1, "attach a click event","nothing","never use it","listens to HTML"],
    ["What does DOM stand for?", "http://placehold.it/300x300", 1, "Document Object Model","Document Over Mountains","Do Over Model","Nothing",1],
    ["Question 3?", "http://placehold.it/400x400", 4,  "attach a click event","nothing","never use it","listens to HTML",1],
  ];
	console.log(lengthofobject);
	
	var lengthofobject = Object(data.quizcontent).length;
	var myQuestions = document.getElementById("questions");
	var myHeader = document.getElementById("quizHeader");
	var quizImage = document.getElementById("quizimage");
  var classname = document.getElementsByClassName("answer");
	var progressBar = document.getElementById("progressbar");
	var btnPrevious = document.getElementById("btnPrevious");
	var btnNext = document.getElementById("btnNext");
	var btnFinish = document.getElementById("finishQuiz");
	
	btnNext.addEventListener("click", moveNext);
	btnPrevious.addEventListener("click", moveBack);
	btnFinish.addEventListener("click", endQuiz);
	
//	console.log(myQuestions);
	console.dir(myQuestions);
//	console.log(myQuestions.children[0]);
	console.dir(myQuestions.children[0]);
//	console.log(myQuestions.children[1]);
	console.dir(myQuestions.children[1]);
//	console.log(myQuestions.children[2]);
	console.dir(myQuestions.children[2]);
//	console.log(myQuestions.children[3]);
	console.dir(myQuestions.children[3]);
	
	
  checkPage(0);
  console.log(classname);
	console.log("classname.length = " + classname.length);
  for (var i = 0; i < classname.length; i++) {
    classname[i].addEventListener("click", myAnswer, false);
  }

  function myAnswer() {
    var idAnswer = this.getAttribute("data-id");
//		console.log(idAnswer);
		// Check for correct answer
		myAnswers[curPage] = idAnswer;
//		if(myQuiz[curPage][2] == idAnswer){
		if(data.quizcontent[curPage][correct] == idAnswer){
			console.log('Correct Answer');
		}
		else {
			console.log('Wrong Answer');
		}
		console.log(myAnswers);
  }
	
	function addBox() {
		for(var i = 0; i < myQuestions.children.length; i++){
			var curNode = myQuestions.children[i];
			if(myAnswers[curNode] == (i+1)){
				curNode.classList.add("selAnswer");
			}
			else{
				curNode.classList.remove("selAnswer");
			}
		}
	}

  function moveNext() {
		if(myAnswers[curPage]){
			console.log('Okay to Proceed')
			if(curPage < (lengthofobject-1)){
				curPage++;
				checkPage(curPage);
			}
			else if(lengthofobject <= curPage) {
				endQuiz();
			}
			else {
				console.log('end of quiz Page' + curPage);
			}
		}
		else{
			console.log('not answered');
		}
	}
	
	function	endQuiz(){
		console.log(lengthofobject);
		console.log(myAnswers[lengthofobject]);
		console.log(curPage);
		console.log(myAnswers[curPage]);
		if(myAnswers[curPage]){
			var output = "<div class='output'>Quiz Results<br>";
			var questionResult = "NA";
			console.log('Quiz is OVER');
			for(var i = 0; i < myAnswers.length; i++){
//				if(myQuiz[i][2 ] == myAnswers[i]) {
				if(data.quizcontent[i][correct] == myAnswers[i]){
					questionResult = '<i class="fa fa-check-circle-o" aria-hidden="true"></i>';
//					questionResult = '<span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>';
					correct++;
				}
				else {
					questionResult = '<i class="fa fa-times-circle-o" aria-hidden="true"></i>';
					
//					questionResult = '<span class="glyphicon glypicon-remove-circle" aria-hidden="true"></span>';
				}
				output = output + '<p>Question ' + (i+1) + ' ' + questionResult + '</p>';
				console.log(output);
			}
			output = output + '<p>You scored ' + correct + ' out of ' + lengthofobject + '</p></div> ';
			document.getElementById("quizContent").innerHTML = output;
		}
		else{
			console.log('not answered');
		}
	}
  function checkPage(i) {
		// add remove disabled buttons if there are no more questions in queue
		if(curPage == 0) {
//			btnPrevious.classList.add("disabled");
			btnPrevious.classList.add("hide");
		}
		else {
			btnPrevious.classList.remove("hide");
		}
		if((curPage + 1) < (lengthofobject)){
			btnNext.classList.remove("hide");
			btnFinish.classList.add("hide");
		}
		else {
			btnNext.classList.add("hide"); 
			btnFinish.classList.remove("hide");
		}
		console.log('cal ' + lengthofobject + ' ' + curPage);
		
		
		
	
		
		console.log(curPage+1);
//    myHeader.innerHTML = myQuiz[curPage][0];
    myHeader.innerHTML = data.quizcontent[curPage].question;
//		quizImage.src = myQuiz[curPage][1];
		quizImage.src = data.quizcontent[curPage].image;
    for (var i = 0; i < myQuestions.children.length; i++) {
      var curNode = myQuestions.children[i];
//      console.log(curNode.childNodes[1].innerHTML);
//			console.log(myQuiz[curPage][(i+1)])
//			console.log(curNode);
//			console.dir(curNode);
			console.log(curNode.childNodes[0]);
			console.dir(curNode.childNodes[0]);
//			console.log(curNode.childNodes[1]);
//      curNode.childNodes[0].innerHTML = capitalise(myQuiz[curPage][(i+3)]);
      curNode.childNodes[0].innerHTML = capitalise(data.quizcontent[curPage]["a"+(i+1)]);
			
			// Check if answered already
			if(myAnswers[curPage] == (i+1)){
				curNode.classList.add("selAnswer");
			}
			else{
				curNode.classList.remove("selAnswer");
			}
    }
		
		// Update progress bar
		var increment = Math.ceil((curPage+1) / (lengthofobject)*100);
		progressBar.style.width = (increment) + '%';
		progressBar.innerHTML = (increment) + '%';
  }

  function moveBack() {
		if(myAnswers[curPage]){
			console.log('Okay to Proceed')
			if (curPage > 0) {
				curPage--;
				checkPage(curPage);
			}
			else {
				console.log('end of quiz Page ' + curPage);
			}
		}
		else {
			console.log('not answered');
		}
 }
 function capitalise(str){
	 return str.substr(0,1).toUpperCase() + str.substr(1);
 }
</script>
